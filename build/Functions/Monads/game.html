<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="content-security-policy" content="">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-b6adefe3.css">
	<link rel="stylesheet" href="/_app/assets/pages/Functions/__layout.svelte-45d8fac8.css">
	<link rel="stylesheet" href="/_app/assets/pages/Functions/Monads/__layout.svelte-ed3bdd87.css">
	<link rel="stylesheet" href="/_app/assets/pages/Functions/Monads/game.svelte-e6dee2aa.css">
	<link rel="stylesheet" href="/_app/assets/Button.svelte_svelte_type_style_lang-63f25223.css">
	<link rel="modulepreload" href="/_app/start-b6a591d0.js">
	<link rel="modulepreload" href="/_app/chunks/vendor-7ab9b2a4.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-31f91b2d.js">
	<link rel="modulepreload" href="/_app/pages/Functions/__layout.svelte-c22d6533.js">
	<link rel="modulepreload" href="/_app/pages/Functions/Monads/__layout.svelte-880bf17c.js">
	<link rel="modulepreload" href="/_app/pages/Functions/Monads/game.svelte-7e53b39a.js">
				<script>
		if ('serviceWorker' in navigator) {
			navigator.serviceWorker.register('/service-worker.js');
		}
	</script>

<script
  src="https://code.jquery.com/jquery-1.12.4.min.js"
  integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
  crossorigin="anonymous"></script>

  <script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
  integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
  crossorigin="anonymous"></script>

  <script src="https://cdn.socket.io/4.4.0/socket.io.min.js" integrity="sha384-1fOn6VtTq3PWwfsOrk45LnYcGosJwzMHv+Xh/Jx5303FVOXzEnw0EpLv30mtjmlj" crossorigin="anonymous"></script>


	</head>
	
	<body>
		<div id="svelte" >


<div><nav><ul class="svelte-1ofk2mc"><li class="svelte-1ofk2mc"><a href="/">Home</a></li>

    <li class="svelte-1ofk2mc"><a href="/Functions">Functions</a></li>

    <li class="svelte-1ofk2mc"><a href="/Mahjong">Riichi Mahjong</a></li>

    <li class="svelte-1ofk2mc"><a href="/Grammar">Grammar</a></li>

    <li class="svelte-1ofk2mc"><a href="/Law">Rule By Law</a></li></ul></nav></div>


<div></div>
<div class="container svelte-1ofk2mc"><br>
<div style="font-size: 26px">Functions</div>


<nav><ul class="svelte-14w1mcn"><li class="svelte-14w1mcn"><a href="/Functions/" class="svelte-14w1mcn">Home</a></li>

        <li class="svelte-14w1mcn"><a href="/Functions/haskell" class="svelte-14w1mcn">Haskell</a></li>

      	<li class="svelte-14w1mcn"><a href="/Functions/bitmask_prime_generator" class="svelte-14w1mcn">Primes</a></li>

		<li class="svelte-14w1mcn"><a href="/Functions/factors" class="svelte-14w1mcn">Factors</a></li>

		<li class="svelte-14w1mcn"><a href="/Functions/proxy" class="svelte-14w1mcn">Proxies</a></li>

        <li class="svelte-14w1mcn"><a class="large svelte-14w1mcn" href="/Functions/Monads">Monads</a></li>

        <li class="svelte-14w1mcn"><a class="large svelte-14w1mcn" href="/Functions/Binary_Operations">Binary</a></li>

		<li class="svelte-14w1mcn"><a href="/Functions/score" class="svelte-14w1mcn">Score</a></li></ul></nav>


<br>
<div style="font-size: 26px">Monads</div>


<nav><ul class="svelte-1e9oi5x"><li class="svelte-1e9oi5x"><a href="/Functions/Monads/" class="svelte-1e9oi5x">Home</a></li>

      	<li class="svelte-1e9oi5x"><a href="/Functions/Monads/Monad" class="svelte-1e9oi5x">Monads</a></li>

		<li class="svelte-1e9oi5x"><a href="/Functions/Monads/Monad0" class="svelte-1e9oi5x">A Simple Monad</a></li>

		<li class="svelte-1e9oi5x"><a href="/Functions/Monads/ObjectMonad" class="svelte-1e9oi5x">Object Monads</a></li>

        <li class="svelte-1e9oi5x"><a href="/Functions/Monads/Async_monad" class="svelte-1e9oi5x">Async Monad</a></li>

        <li class="svelte-1e9oi5x"><a href="/Functions/Monads/game" class="svelte-1e9oi5x">Score</a></li></ul></nav>


<h1 class="svelte-1pzbx45">_______________________________________________________________
</h1>
<div style="font-family: Times New Roman; text-align: center; font-size: 38px;">The Game of Score Server
<br>
  <span style="font-style: italic; font-size: 34px">Using a JavaScript Ersatz Monad </span></div>
<a href="https://www.random.org/integers/?num=1&min=1&max=6&col=1&base=10&format=plain&rnd=new">Link</a>
<p>This page will demonstrate the use of recursive explicit closures spawned by a function M defined below. I sometimes call these closures &quot;monads&quot; partly because, like Haskell monads, they facilitate composing functions on encapsulated values. More about this is at <a href="../Monads/">Home</a></p>
<p>I wrote &quot;explicit&quot; because all functions are closures, as explained in <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">CLOSURES</a>. By the way, the word &quot;ersatz&quot; in the caption is there for critics who complain these aren&#39;t Category Theory monads. Some of these critics will be surprised to learn that Haskell monads aren&#39;t Catagory Theory monads either. </p>



<h2>The Project</h2>

<p>I&#39;m going to construct an interactive simulated dice game my son taght me. It&#39;s called &quot;Score&quot;. I wrote an elaborate version of the game of Score around eight years ago, using a Haskell WebSockets server to manage multiple clients and interacting groups of clients, compute all of the possible solutiong to each roll of the dice unless no solution existed, and more. It also featured a shared todo list for each group along with a group chat application. It isn&#39;t up and running right now, although I do revive it from time to time.</p>
<p>This version will be much simpler. I&#39;ll begin by defining a simple monad constructor named M. </p>

<pre>function M (x) {
  return function go (func) {
      if (typeof func === &quot;function&quot;) {
          x = func(x);
          return go;
      }
      else if (func === &quot;stop&quot;) return x;
  }
}; </pre>

<span>Here&#39;s how it works: </span>

<pre>var someMonad = M(3)
someMonad(v=&gt;v**3);
someMonad(&#39;stop&#39;);  // 27
someMonad(v=&gt;v+15)(&#39;stop&#39;);  // 42 .. Now let&#39;s go back to 42 the hard way:
someMonad(v=&gt;v/7)(v=&gt;v+2)(v=&gt;v*v)(v=&gt;v**(1/6))(v=&gt;v*21)(&#39;stop&#39;); // 42 </pre>
<p>Now I&#39;ll test M with an array these functions:</p>
<pre>function g(ar) {
  var x = (ar.pop())**3;
  ar.unshift(x);
  return ar;
};
function g2 (ar) {return (ar.flatMap(v =&gt; (v+1)**3))};
function g3 (ar) {return (ar.flatMap(v =&gt; Math.round(v**(1/3))))};</pre>
<p>First, I&#39;ll use M to define a monad named &quot;mon&quot; by calling &quot;var mon = M([1,2,3,4])&quot;. You&#39;ll see the return value of &quot;mon3(&#39;stop&#39;)&quot; dislayed, &quot;[1,2,3,4]&quot;. mon(g)(&#39;stop&#39;) returns &quot;[64,1,2,3]&quot;, as seen by clicking &quot;mon3(g)&quot;. I call &quot;mon(g)&quot; twice more, causing &quot;[8,27,64,1]&quot; to be displayed. That&#39;s the value stored in mon3 and returned by mon3(&#39;stop&#39;), and is the array that was expected.</p>
<p>After clicking &quot;Re-set mon3&quot;, mon(g)(g(g)(g)(g3)) returns [1,2,3,4]. You can verify this by clicking &quot;mon3(g)&quot; four times and &quot;mon3(g3)&quot; once. If you click &quot;mon3(g2)&quot; three times and then &quot;mon3(g3)&quot; three times, mon3(&#39;stop&#39;) is displayed and is &quot;[2,3,4,5]&quot;, as expected. Check it out below:&quot;
</p><h1 class="svelte-1pzbx45">1,2,3,4</h1>
<button class="svelte-1pzbx45">mon3(g)</button>
<button class="svelte-1pzbx45">mon3(g2)</button>
<button class="svelte-1pzbx45">mon3(g3)</button>
<button class="svelte-1pzbx45">Reset mon3</button>
<br><br><br>

<button style="display: none" class="svelte-1pzbx45">none</button> 
<button style="display: none" class="svelte-1pzbx45">none</button> 
<button style="display: none" class="svelte-1pzbx45">none</button> 
<button style="display: none" class="svelte-1pzbx45">none</button>

<br><br>
<button class="svelte-1pzbx45">ROLL</button>
<br><br>
<button style="display: none" class="svelte-1pzbx45">undefined</button> 
<button style="display: none" class="svelte-1pzbx45">undefined</button> 
<button style="display: none" class="svelte-1pzbx45">undefined</button> 
<button style="display: none" class="svelte-1pzbx45">undefined</button>

<h1 class="svelte-1pzbx45">undefined ** undefined ** undefined ** undefined **</h1>
<br><br><br><br><br><br><br><br><br><br>
<p>Here&#39;s the HTML code for the first demo:</p>
<pre>var mon3 = M([1,2,3,4]);
&lt;h1&gt;{mon3(s)}&lt;/h1&gt;
&lt;button on:click={() =&gt; fmon3(g)}&gt;mon3(g)&lt;/button&gt;
&lt;button on:click={() =&gt; fmon3(g2)}&gt;mon3(g2)&lt;/button&gt;
&lt;button on:click={() =&gt; fmon3(g3)}&gt;mon3(g3)&lt;/button&gt;
&lt;button on:click={fmon3Reset}&gt;Re-set mon3&lt;/button&gt;
WHERE fmon3 and fmon3Reset are:
function fmon3 (f) {mon3 = mon3(f)}; // Updates the DOM
function fmon3Reset () {mon3 = M([1,2,3,4])}</pre></div>


		<script type="module" data-hydrate="vlagxf">
		import { start } from "/_app/start-b6a591d0.js";
		start({
			target: document.querySelector('[data-hydrate="vlagxf"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-31f91b2d.js"),
						import("/_app/pages/Functions/__layout.svelte-c22d6533.js"),
						import("/_app/pages/Functions/Monads/__layout.svelte-880bf17c.js"),
						import("/_app/pages/Functions/Monads/game.svelte-7e53b39a.js")
				],
				params: {}
			}
		});
	</script></div>
	</body>
</html>
